# 局域网文件上传器

一个简单的、自托管的 Node.js 服务器，用于在您的局域网 (LAN) 内快速上传和分享文件。

此版本包含多用户支持，每个用户通过一个唯一的 UUID 进行隔离。

[English](README.md)

## 功能特性

* **友好登录**: 使用一个简单的 UUID 登录服务。
* **UUID 生成**: 在登录页面一键生成新的 UUID。
* **隔离存储**: 文件根据用户的 UUID 存储在服务器上的不同文件夹中。
* **简洁的 Web 界面**：直接从浏览器上传文件和文件夹。
* **文件列表**：在主页上查看您所有已上传的文件（包括子文件夹中的文件）。
* **安全注销**: 注销按钮会安全地结束您的会话，并*永久删除您的所有文件*。
* **解决冲突**：如果已存在同名文件，会自动添加时间戳重命名。
* **编码修复**：正确处理非 ASCII（例如中文）文件名，防止乱码。
* **多语言支持**：自动检测浏览器语言，在英文 (`en`) 和简体中文 (`zh`) 之间切换。
* **日志记录**: 在 `/logs` 目录下的日志文件中记录用户活动（登录、上传、下载、注销）。

## 环境要求

* [Node.js](https://nodejs.org/) (v14.14.0 或更高版本, 需要 `fs.rm` 支持)
* [npm](https://www.npmjs.com/) (通常随 Node.js 一起安装)

## 安装

1.  克隆此仓库或下载源代码。
2.  在项目根目录中打开一个终端。
3.  安装所需的依赖：

    ```bash
    npm install express multer cookie-parser express-session uuid winston winston-daily-rotate-file
    ```

## 如何运行

1.  在终端中，运行服务器：

    ```bash
    npm start
    ```
    (该命令会执行 `package.json` 中定义的 `node src/server.js`)

2.  服务器启动后，将在控制台中打印访问 URL：

    ```
    🚀 服务器已启动！ (正在监听端口 3000)
    请在浏览器中访问以下地址:
        - 本机: http://localhost:3000
        - 局域网: [http://192.168.1.100:3000](http://192.168.1.100:3000)
    ```

3.  在浏览器中打开上述任意一个 URL。
4.  系统会提示您登录。您可以粘贴一个已有的 UUID，或点击“一键生成新 UUID”来创建一个。
5.  开始上传文件。您的文件现在只能被使用您 UUID 的会话访问。

## 工作原理

* **服务器**：一个 `express` 服务器在 `0.0.0.0` (所有网络接口) 的 `3000` 端口上进行监听。
* **认证**：使用 `express-session` 和 `cookie-parser` 管理用户会话。存储在会话中的 UUID 用于识别用户。
* **上传**：使用 `multer` 来处理 `multipart/form-data` (文件上传)。
* **存储**：文件被保存到用户专属目录中：`uploads/<USER-UUID>/`。
* **文件服务**：`/files` 路由受到动态保护，仅提供登录用户对应目录下的文件。
* **日志**: 使用 `winston` 在 `logs/` 目录下创建轮替的日志文件，追踪用户操作。